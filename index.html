<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Catálogo de análisis cartográficos</title>
    <meta name="author" content="Derek Eder">
    <meta content="Display any CSV file as a searchable, filterable, pretty HTML table" />

    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/select2.min.css" rel="stylesheet">
    <style type="text/css">
      .sombra {
        box-shadow: 0 1px 2px rgba(0,0,0,0.15);
        transition: box-shadow 0.3s ease-in-out;
      }

      .sombra:hover {
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.8)
      }
    </style>
  </head>

  <body>
    <div class="container">
      <div class="row mt-5">
        <h2>Catálogo de análisis cartográficos</h2>
      </div>

      <div class="row mt-5">
        <div class="col-4">
          <select class="js-states form-control" id="filtro_status" multiple="multiple">
            <option>En Proceso</option>
            <option>Validado</option>
          </select>
        </div>
        <div class="col-4">
          <select class="js-states form-control" id="filtro_gerencia" multiple="multiple">
            <option>(GTGIR) Gerencia Técnica de Gestión Integral del Riesgos.</option>
            <option>(GTGIR)Gerencia Técnica de Gestión Integral del Riesgos.</option>
            <option>(GTM) Gerencia Técnica de Movilidad.</option>
            <option>(GTOTGS) Gerencia Técnica de Ordenamiento Territorial y Gestión del Suelo.</option>
          </select>
        </div>
        <div class="col-4">  
          <select class="js-states form-control" id="filtro_tematica_prin" multiple="multiple">
            <option>DCU</option>
            <option>DIM</option>
            <option>GIA</option>
            <option>GRS</option>
            <option>HEM</option>
            <option>IVT</option>
            <option>PMR</option>
            <option>POT</option>
            <option>PRE</option>
            <option>SRT</option>
          </select>
        </div>
      </div>
      <div class="row mt-3">
        <div class="col-4">
          <select class="js-states form-control" id="filtro_tematica_sec" multiple="multiple">
            <option>DCU</option>
            <option>DIM</option>
            <option>GIA</option>
            <option>IVT</option>
            <option>PMR</option>
            <option>POT</option>
            <option>PRE</option>
            <option>SRT</option>
          </select>
        </div>
        <div class="col-4">
          <select class="js-states form-control" id="filtro_analisis" multiple="multiple">
            <option>Base</option>
            <option>Diagnóstico</option>
            <option>Estratégia</option>
          </select>
        </div>
        <div class="col-4">
          <input type="text" class="form-control" placeholder="Buscar">
        </div>
      </div>

      <nav class="mt-5" aria-label="Page navigation example">
        <ul class="pagination justify-content-end">
          <li class="page-item disabled">
            <a class="page-link" href="#" aria-label="Previous">
              <span aria-hidden="true">&laquo;</span>
            </a>
          </li>
          <li class="page-item"><a class="page-link" href="#">1</a></li>
          <li class="page-item"><a class="page-link" href="#">2</a></li>
          <li class="page-item"><a class="page-link" href="#">3</a></li>
          <li class="page-item">
            <a class="page-link" href="#" aria-label="Next">
              <span aria-hidden="true">&raquo;</span>
            </a>
          </li>
        </ul>
      </nav>
 
      <div class="row mt-3" id='table'>
        <!--<div id='table'></div>-->
      </div>
    </div>

    <!--<footer class='footer'>
      <div class='container'>
        <hr />
        <p class='pull-right'><a href='http://imeplan.mx/'>CSV to HTML Table</a> by <a href='http://imeplan.mx/'>IMEPLAN</a></p>
      </div>
    </footer>-->

    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/select2.min.js"></script>
    <script type="text/javascript" src="js/papaparse.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript">
        var filter_status = [];
        var filter_gerencia = [];
        var filter_tematica_prin = [];
        var filter_tematica_sec = [];
        var filter_tipo = [];
        var data_csv = [];
        var paginacion = 0;
        
      $(document).ready(function(){
        $("#filtro_status").select2({
          width: 'resolve',
          language: "es",
          placeholder: 'Estatus del análisis'
        });
        $("#filtro_gerencia").select2({
          width: 'resolve',
          language: "es",
          placeholder: 'Gerencia'
        });
        $("#filtro_tematica_prin").select2({
          width: 'resolve',
          language: "es",
          placeholder: 'Temática principal LGAHOTDU'
        });
        $("#filtro_tematica_sec").select2({
          width: 'resolve',
          language: "es",
          placeholder: 'Temática secundaria LGAHOTDU'
        });
        $("#filtro_analisis").select2({
          width: 'resolve',
          language: "es",
          placeholder: 'Tipo de análisis'
        });
        var config = {download: true, delimiter: ","};
        var file = "data/rac_18022020.csv";

        var csv = Papa.parse(file, {
                                    download: true, delimiter: ",",
                                    complete: function(results) {
                                      data_csv = results.data;
                                      loadData(results.data, 1, 24);
                                    }
                                  });
      });
      function loadData(csv_data, start, limit){
        for(var i = start; i < limit; i++){
          var status = (csv_data[i][5] != '')? csv_data[i][5] : 'Sin status';
          var color = (csv_data[i][24] != '')? csv_data[i][24] : '#989898';
          var link = (csv_data[i][20] != '')? '<a style="color:#212529;text-decoration: none;" href="'+csv_data[i][20]+'" target="_blank">VER MAPA</a>' : '';
          var tiulo_proyecto = csv_data[i][1] + " - " + csv_data[i][2];
          var titulo = csv_data[i][4];
          var gerencia = csv_data[i][6];
          var tematica_prin = csv_data[i][9];
          var tematica_sec = csv_data[i][10];
          var analisis = csv_data[i][11];
          var miniatura = (csv_data[i][20] != '')? csv_data[i][20].replace("open", "thumbnail")+"&sz=w400-h300-p-k-nu" : csv_data[i][20];

          $("#table").append("<div class='col-3'><div class='sombra card mb-3' style='background-color: "+color+" !important;'><div class='card-header' style='background: linear-gradient(to bottom, rgba(0, 0, 0, 0.6) 0%, rgba(0, 0, 0, 0.6) 100%), url("+miniatura+") no-repeat;'><ul class='list-group' style='color: "+color+";'><li class='list-group-item' style='background-color: #00000000; border-color: "+color+" !important;'>"+gerencia+"</li></ul><label class='mt-3' style='color: "+color+";'>"+tiulo_proyecto+"</label></div><div class='card-body'><p class='card-text'>"+titulo+"</p></div><div class='card-footer bg-transparent'>"+link+"</div></div></div>");
        }
      }
      $("#filtro_status").on("change", function(){
        console.log("hola")
      });
      /*text filtra por tiulo_proyecto y por titulo*/
    </script>
  </body>
</html>
